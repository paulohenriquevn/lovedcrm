# exec-context

**üö® AVISO CR√çTICO: Este agente DEVE usar ferramentas Read/LS/Bash/Grep para analisar o codebase REAL antes de qualquer contextualiza√ß√£o. Contextos baseados em suposi√ß√µes s√£o FALHA CR√çTICA.**

**Especialista em CONTEXTUALIZA√á√ÉO COMPLETA DE CODEBASE com AN√ÅLISE PROFUNDA OBRIGAT√ìRIA, mapeando arquitetura + estado atual + padr√µes + configura√ß√µes + depend√™ncias + hist√≥rico para gerar contextos t√©cnicos com 99% de certeza absoluta sobre o projeto.**

**üìã LEITURA OBRIGAT√ìRIA ANTES DE QUALQUER CONTEXTUALIZA√á√ÉO:**

- ‚úÖ **DEVE**: Read CHANGELOG.md - ANALISAR hist√≥rico completo de implementa√ß√µes do projeto

**Entrada:**

- Nenhuma (analisa projeto completo automaticamente)

**Sa√≠da**: Contextualiza√ß√£o completa salva automaticamente em `docs/context/PROJECT-CONTEXT-[TIMESTAMP].md`

**Uso:**

```bash
/exec-context
```

---

## üë∂ **PARA DESENVOLVEDORES J√öNIOR - O QUE ESTE AGENTE FAZ**

### **üéØ ANALOGIA SIMPLES: DETETIVE T√âCNICO COMPLETO**

Imagine um detetive que ao chegar em uma cena:

- **Examina** cada evid√™ncia f√≠sica (arquivos do projeto)
- **Mapeia** todas as conex√µes (arquitetura e depend√™ncias)
- **Reconstitui** a cronologia dos eventos (hist√≥rico de mudan√ßas)
- **Identifica** padr√µes e pr√°ticas estabelecidas
- **Documenta** tudo para que qualquer investigador entenda o caso completo

### **üìù EXEMPLO PR√ÅTICO**

**Input**: `/exec-context`

**O agente vai:**

1. **`Read package.json`** ‚Üí Mapear Next.js 14, React 18, shadcn/ui, depend√™ncias exatas
2. **`Read requirements.txt`** ‚Üí Mapear FastAPI, SQLAlchemy, vers√µes Python exatas
3. **`LS api/models/`** ‚Üí Catalogar todos os models: user.py, organization.py, crm_lead.py
4. **`LS components/`** ‚Üí Mapear estrutura completa de componentes + padr√µes
5. **`Read migrations/001_consolidated_schema.sql`** ‚Üí Analisar schema completo do banco
6. **`Grep "organization_id" api/`** ‚Üí Validar implementa√ß√£o multi-tenancy
7. **`Read CLAUDE.md`** ‚Üí Extrair regras e padr√µes definidos
8. **`Bash git log --oneline -10`** ‚Üí Mapear hist√≥rico recente
9. **Contextualizar**: "Sistema multi-tenant SaaS B2B com 38 tabelas + 60+ endpoints production-ready"

**Output**: Documento completo com mapa total do projeto, arquitetura, estado atual, padr√µes estabelecidos, configura√ß√µes cr√≠ticas e guia de desenvolvimento.

### **‚úÖ GARANTIAS**

- **Zero suposi√ß√µes**: Cada informa√ß√£o baseada em leitura real de arquivos
- **Mapa completo**: Cobertura total da arquitetura e configura√ß√µes
- **Estado atual**: Reflete exatamente o que est√° implementado agora
- **Padr√µes identificados**: Documenta conventions e patterns j√° estabelecidos
- **Hist√≥rico mapeado**: Contexto evolutivo do projeto

### **üîÑ QUANDO USAR**

```mermaid
graph LR
    A[Novo desenvolvedor] --> B[/exec-context]
    B --> C[Contexto completo]
    C --> D[exec-refine/story/run]

    E[Projeto complexo] --> B
    F[Onboarding] --> B
    G[Auditoria t√©cnica] --> B
    H[Handover] --> B
```

**Casos de Uso:**

1. **Onboarding**: Novo desenvolvedor entende projeto completo em 1 leitura
2. **Handover**: Transfer√™ncia de conhecimento t√©cnico completa
3. **Auditoria**: Assessment completo de arquitetura e implementa√ß√£o
4. **Debugging**: Contexto total para resolver problemas complexos

---

## üß† **PENSAR ANTES DE AGIR - REGRA UNIVERSAL**

### **üö® PAUSA OBRIGAT√ìRIA ANTES DE QUALQUER A√á√ÉO**

**REGRA FUNDAMENTAL**: Este agente NUNCA deve iniciar qualquer processamento sem primeiro PENSAR e PLANEJAR suas a√ß√µes.

**PROCESSO OBRIGAT√ìRIO DE REFLEX√ÉO (3-5 minutos)**:

#### **üéØ ETAPA 1: COMPREENDER O PEDIDO (30s)**

- ‚ùì **Pergunta**: "O que exatamente preciso contextualizar?"
- üìù **Resposta**: [Mapeamento completo de arquitetura + estado + padr√µes + configura√ß√µes]
- ‚úÖ **Valida√ß√£o**: "Tenho 95% de certeza sobre o escopo da contextualiza√ß√£o?"

#### **üîç ETAPA 2: ANALISAR PR√â-REQUISITOS (90s)**

- üìã **Pergunta**: "Que arquivos e estruturas preciso analisar?"
- üîé **Resposta**: [Configura√ß√µes, c√≥digo, schema, depend√™ncias, hist√≥rico, documenta√ß√£o]
- ‚ö†Ô∏è **Valida√ß√£o**: "Posso mapear completamente com as ferramentas dispon√≠veis?"

#### **‚öôÔ∏è ETAPA 3: PLANEJAR ABORDAGEM (90s)**

- üõ£Ô∏è **Pergunta**: "Qual √© a sequ√™ncia √≥tima de an√°lise?"
- üìà **Resposta**: [Config ‚Üí Dependencies ‚Üí Architecture ‚Üí Patterns ‚Üí History ‚Üí Documentation]
- üéØ **Valida√ß√£o**: "Esta sequ√™ncia gera contexto completo e preciso?"

#### **üö® ETAPA 4: VALIDAR PRINC√çPIOS (30s)**

- üî¥ **KISS**: Esta abordagem √© a mais simples e eficaz?
- üî¥ **COMPLETUDE**: Cobrir√° todos os aspectos cr√≠ticos do projeto?
- üî¥ **PRECIS√ÉO**: Baseada em evid√™ncias reais, n√£o suposi√ß√µes?
- üî¥ **99% CERTEZA**: Tenho confian√ßa absoluta na metodologia?

**‚ùå SE QUALQUER VALIDA√á√ÉO FALHAR**: PARAR e refinar abordagem
**‚úÖ SE TODAS VALIDA√á√ïES PASSAREM**: Prosseguir com an√°lise sistem√°tica

### **üìù TEMPLATE DE REFLEX√ÉO OBRIGAT√ìRIA**

Antes de iniciar qualquer contextualiza√ß√£o, o agente DEVE exibir:

```
üß† PENSANDO ANTES DE CONTEXTUALIZAR...

‚úÖ COMPREENS√ÉO: [Mapeamento completo de arquitetura + estado + padr√µes]
‚úÖ PR√â-REQUISITOS: [An√°lise de configs + c√≥digo + schema + depend√™ncias + hist√≥rico]
‚úÖ PLANO: [Sequ√™ncia sistem√°tica de an√°lise com ferramentas espec√≠ficas]
‚úÖ VALIDA√á√ÉO: KISS ‚úì COMPLETUDE ‚úì PRECIS√ÉO ‚úì 99% CERTEZA ‚úì

üöÄ INICIANDO CONTEXTUALIZA√á√ÉO SISTEM√ÅTICA...
```

**TEMPO INVESTIDO**: 3-5 minutos de planejamento garantem contextualiza√ß√£o completa e precisa.

---

## üö® **RED FLAGS CR√çTICOS - QUANDO PARAR IMEDIATAMENTE**

### **‚õî SITUA√á√ïES QUE EXIGEM PAUSA OBRIGAT√ìRIA**

**REGRA FUNDAMENTAL**: Se qualquer red flag for detectado, o agente DEVE parar imediatamente e reportar o problema.

#### **üî¥ RED FLAGS DE ACESSO E ESTRUTURA**

- ‚ùå **Estrutura corrompida**: Arquivos fundamentais do projeto faltando ou corrompidos
- ‚ùå **Permissions negadas**: N√£o consegue ler arquivos cr√≠ticos necess√°rios
- ‚ùå **Git inacess√≠vel**: Reposit√≥rio sem hist√≥rico ou corrompido
- ‚ùå **Dependencies quebradas**: package.json/requirements.txt com conflitos cr√≠ticos
- ‚ùå **Build failures**: Projeto n√£o compila ou tem erros fundamentais

#### **üî¥ RED FLAGS DE CONFIGURA√á√ÉO**

- ‚ùå **Environment missing**: Arquivos .env ou configura√ß√µes cr√≠ticas ausentes
- ‚ùå **Database unreachable**: N√£o consegue acessar schema ou migrations
- ‚ùå **Config conflicts**: Configura√ß√µes conflitantes entre ambientes
- ‚ùå **Migration failures**: Schema atual n√£o corresponde √†s migrations
- ‚ùå **Service dependencies**: Servi√ßos externos cr√≠ticos inacess√≠veis

#### **üî¥ RED FLAGS DE ARQUITETURA**

- ‚ùå **Pattern inconsistency**: Padr√µes arquiteturais conflitantes ou quebrados
- ‚ùå **Multi-tenancy violations**: Organization isolation comprometido
- ‚ùå **Security vulnerabilities**: Configura√ß√µes de seguran√ßa cr√≠ticas expostas
- ‚ùå **Performance bottlenecks**: Problemas de performance evidentes
- ‚ùå **Technical debt explosion**: C√≥digo base em estado cr√≠tico

### **‚ö° A√á√ÉO IMEDIATA QUANDO RED FLAG DETECTADO**

```
üö® RED FLAG DETECTADO: [Tipo do red flag]

‚ö†Ô∏è PROBLEMA CR√çTICO: [Descri√ß√£o espec√≠fica do problema]

üõë PAUSANDO CONTEXTUALIZA√á√ÉO

üìã NECESS√ÅRIO RESOLVER PRIMEIRO:
- [Item espec√≠fico que impede contextualiza√ß√£o completa]
- [Recurso/acesso faltante]
- [Configura√ß√£o que precisa corre√ß√£o]

üîß A√á√ÉO REQUERIDA: [A√ß√£o espec√≠fica para resolver problema]

‚è≥ AGUARDANDO RESOLU√á√ÉO ANTES DE CONTINUAR...
```

### **‚úÖ COMO RESOLVER RED FLAGS**

- **Fix access first** - resolver permiss√µes e acessos cr√≠ticos
- **Repair structure** - corrigir estrutura de arquivos fundamentais
- **Resolve conflicts** - resolver conflitos de configura√ß√£o
- **Validate setup** - garantir que ambiente est√° funcional
- **Test fundamentals** - validar que projeto compila e roda

**LEMBRE-SE**: Contextualiza√ß√£o incompleta = decis√µes t√©cnicas erradas + retrabalho massivo.

---

## üö® **MISS√ÉO: CONTEXTUALIZA√á√ÉO COMPLETA COM 99% CERTEZA**

### **PROCESSO AUTOM√ÅTICO EM 7 FASES COM AN√ÅLISE SISTEM√ÅTICA**

**O agente NUNCA deve gerar contexto sem 99% de certeza sobre o estado atual do projeto. SEMPRE usar ferramentas de an√°lise at√© atingir mapeamento completo.**

#### **üîç FASE 1: AN√ÅLISE DE CONFIGURA√á√ïES E AMBIENTE (20min)**

##### **1.1 Mapeamento de Depend√™ncias e Vers√µes**

```bash
# OBRIGAT√ìRIO: Usar ferramentas reais para mapear estado atual
Read package.json          # ‚Üí Extrair vers√µes exatas Frontend
Read requirements.txt       # ‚Üí Extrair vers√µes exatas Backend
Read .env.example          # ‚Üí Mapear vari√°veis de ambiente
Read next.config.js        # ‚Üí Analisar configura√ß√µes Frontend
Read pyproject.toml        # ‚Üí Configura√ß√µes Python (se existir)
```

```yaml
Dependencies Mapeadas:
  Frontend:
    Next.js: [vers√£o EXATA encontrada]
    React: [vers√£o EXATA encontrada]
    TypeScript: [vers√£o EXATA encontrada]
    shadcn/ui: [componentes instalados]
    TanStack Query: [vers√£o para data fetching]
    Zustand: [vers√£o para state management]

  Backend:
    FastAPI: [vers√£o EXATA encontrada]
    SQLAlchemy: [vers√£o EXATA encontrada]
    PostgreSQL: [driver e vers√£o]
    Redis: [vers√£o para cache/sessions]

  Build/Deploy:
    Node: [vers√£o m√≠nima requerida]
    Python: [vers√£o m√≠nima requerida]
    Docker: [se configurado]
    Railway: [configura√ß√µes deployment]
```

##### **1.2 An√°lise de Configura√ß√µes de Ambiente**

```bash
# OBRIGAT√ìRIO: Mapear todas configura√ß√µes cr√≠ticas
Read railway.json          # ‚Üí Configura√ß√µes de deploy
Read docker-compose.yml    # ‚Üí Configura√ß√µes de desenvolvimento
Read Dockerfile           # ‚Üí Configura√ß√µes de container
Read .github/workflows/    # ‚Üí CI/CD se existir
```

```yaml
Environment Configuration:
  Development:
    Database: [PostgreSQL local + configura√ß√µes]
    Cache: [Redis local + configura√ß√µes]
    Ports: [Frontend:3000, Backend:8000]

  Production:
    Platform: [Railway/Vercel/outros]
    Database: [PostgreSQL prod + configura√ß√µes]
    Environment Variables: [Lista de vari√°veis necess√°rias]

  Security:
    JWT: [Configura√ß√µes de autentica√ß√£o]
    CORS: [Configura√ß√µes de CORS]
    Rate Limiting: [Se configurado]
```

#### **üèóÔ∏è FASE 2: AN√ÅLISE DE ARQUITETURA E ESTRUTURA (25min)**

##### **2.1 Mapeamento da Estrutura de Diret√≥rios**

```bash
# OBRIGAT√ìRIO: Mapear estrutura completa do projeto
LS /                       # ‚Üí Estrutura raiz
LS app/                    # ‚Üí Estrutura Next.js App Router
LS api/                    # ‚Üí Estrutura FastAPI Backend
LS components/             # ‚Üí Componentes Frontend
LS migrations/             # ‚Üí Migrations de banco
LS docs/                   # ‚Üí Documenta√ß√£o do projeto
```

```yaml
Project Structure Mapeada:
  Frontend (Next.js 14):
    app/[locale]/admin/: [Estrutura multi-tenant admin]
    components/ui/: [shadcn/ui components - listar todos]
    components/[feature]/: [Feature-specific components]
    hooks/: [Custom hooks]
    services/: [API services]
    types/: [TypeScript types]

  Backend (FastAPI):
    api/core/: [Core infrastructure]
    api/models/: [SQLAlchemy models]
    api/schemas/: [Pydantic schemas]
    api/repositories/: [Data access layer]
    api/services/: [Business logic]
    api/routers/: [API endpoints]

  Database:
    migrations/: [Database migrations]

  Documentation:
    docs/project/: [Project documentation]
    docs/plans/: [Implementation plans]
    docs/refined/: [Technical refinements]
```

##### **2.2 An√°lise de Padr√µes Arquiteturais**

```bash
# OBRIGAT√ìRIO: Identificar padr√µes estabelecidos
Grep "organization_id" api/models/     # ‚Üí Validar multi-tenancy
Grep "BaseService" services/           # ‚Üí Pattern de services
Grep "useOrgContext" hooks/            # ‚Üí Pattern de contexto org
Read api/core/organization_middleware.py # ‚Üí Multi-tenancy implementation
```

```yaml
Architectural Patterns Identificados:
  Multi-Tenancy:
    Strategy: [Header-based isolation com X-Org-Id]
    Implementation: [organization_id FK em todos models]
    Middleware: [api/core/organization_middleware.py]
    Frontend Context: [useOrgContext hook]

  Clean Architecture:
    Layers: [Router ‚Üí Service ‚Üí Repository ‚Üí Model]
    Dependency Injection: [FastAPI Depends pattern]
    Error Handling: [HTTPException pattern]

  Frontend Patterns:
    Data Fetching: [TanStack Query pattern]
    State Management: [Zustand stores]
    Component Architecture: [Decomposition pattern]
    UI Components: [shadcn/ui exclusive usage]
```

#### **üìä FASE 3: AN√ÅLISE DO SCHEMA E MODELOS (20min)**

##### **3.1 Mapeamento do Schema de Banco**

```bash
# OBRIGAT√ìRIO: Analisar schema completo
Read migrations/001_consolidated_schema.sql  # ‚Üí Schema completo
Bash cd migrations && ./migrate status       # ‚Üí Vers√£o atual
LS api/models/                              # ‚Üí Todos os models
```

```yaml
Database Schema Mapeado:
  Tables Count: [X tabelas identificadas]

  Core Tables:
    users: [Estrutura + relacionamentos]
    organizations: [Estrutura + relacionamentos]
    organization_members: [Estrutura + relacionamentos]

  Feature Tables:
    crm_leads: [Estrutura + relacionamentos]
    crm_communications: [Estrutura + relacionamentos]
    billing_subscriptions: [Estrutura + relacionamentos]
    [... outras tabelas mapeadas]

  Multi-Tenancy Implementation:
    Organization Isolation: [organization_id FK em todas tabelas]
    Indexes: [√çndices para performance multi-tenant]
    Constraints: [Restri√ß√µes de integridade]
```

##### **3.2 An√°lise dos Models e Relacionamentos**

```bash
# OBRIGAT√ìRIO: Mapear todos os models
Read api/models/user.py           # ‚Üí Model principal de usu√°rio
Read api/models/organization.py   # ‚Üí Model de organiza√ß√£o
Read api/models/crm_lead.py      # ‚Üí Model de CRM leads
```

```yaml
Models e Relacionamentos:
  SQLAlchemy Version: [Vers√£o identificada]

  User Model:
    Fields: [Lista de campos]
    Relationships: [Relacionamentos identificados]
    Multi-Tenancy: [Como implementa org isolation]

  Organization Model:
    Fields: [Lista de campos]
    Relationships: [Relacionamentos identificados]
    Owner Pattern: [Como ownership √© implementado]

  CRM Lead Model:
    Fields: [Lista de campos]
    Pipeline Stages: [Como stages s√£o implementados]
    Organization Scoping: [Como org isolation √© implementado]
```

#### **üîß FASE 4: AN√ÅLISE DE IMPLEMENTA√á√ïES E ENDPOINTS (25min)**

##### **4.1 Mapeamento de Endpoints da API**

```bash
# OBRIGAT√ìRIO: Mapear todos os endpoints
LS api/routers/               # ‚Üí Todos os routers
Grep "@router" api/routers/   # ‚Üí Todos os endpoints
Read api/main.py             # ‚Üí Como routers s√£o registrados
```

```yaml
API Endpoints Mapeados:
  Authentication:
    POST /auth/register: [Registro de usu√°rio]
    POST /auth/login: [Login]
    POST /auth/logout: [Logout]

  Organizations:
    GET /organizations/: [Listar organiza√ß√µes do usu√°rio]
    POST /organizations/: [Criar organiza√ß√£o]

  CRM Leads:
    GET /crm/leads/: [Listar leads da organiza√ß√£o]
    POST /crm/leads/: [Criar lead]
    PUT /crm/leads/{id}: [Atualizar lead]

  [... outros endpoints mapeados]

  Multi-Tenancy Compliance:
    Organization Middleware: [Aplicado em quais endpoints]
    Header Validation: [X-Org-Id obrigat√≥rio]
    Isolation Testing: [Como isolation √© validado]
```

##### **4.2 An√°lise de Services e Repositories**

```bash
# OBRIGAT√ìRIO: Mapear camada de neg√≥cio
LS api/services/              # ‚Üí Todos os services
LS api/repositories/          # ‚Üí Todos os repositories
Read api/repositories/base.py # ‚Üí Base repository pattern
```

```yaml
Business Logic Layer:
  Services Pattern:
    Base Service: [Pattern base se existir]
    Organization Context: [Como org context √© passado]
    Error Handling: [Pattern de tratamento de erros]

  Repository Pattern:
    Base Repository: [BaseRepository implementation]
    Organization Filtering: [Como org filtering √© implementado]
    Query Optimization: [Patterns de performance]

  Dependency Injection:
    FastAPI Depends: [Como DI √© implementado]
    Database Sessions: [Como sessions s√£o gerenciadas]
    Current User/Org: [Como contexto atual √© injetado]
```

#### **üé® FASE 5: AN√ÅLISE DO FRONTEND E COMPONENTES (25min)**

##### **5.1 Mapeamento de Componentes e UI**

```bash
# OBRIGAT√ìRIO: Mapear frontend completo
LS components/ui/             # ‚Üí shadcn/ui components
LS components/               # ‚Üí Feature components
LS app/[locale]/admin/       # ‚Üí Admin pages structure
```

```yaml
Frontend Architecture:
  UI Framework:
    shadcn/ui Components: [Lista completa de componentes instalados]
    Tailwind CSS: [Configura√ß√£o e customiza√ß√µes]
    Lucide Icons: [Biblioteca de √≠cones usada]

  Component Structure:
    UI Components: [components/ui/ - shadcn exclusivos]
    Feature Components: [components/[feature]/ - espec√≠ficos]
    Layout Components: [components/layout/ - layouts]

  Pages Structure:
    App Router: [app/[locale]/ - Next.js 14]
    Admin Routes: [app/[locale]/admin/ - admin √°rea]
    Auth Routes: [app/[locale]/auth/ - autentica√ß√£o]
    Public Routes: [app/[locale]/landing/ - p√∫blico]
```

##### **5.2 An√°lise de Services e State Management**

```bash
# OBRIGAT√ìRIO: Mapear data layer frontend
LS services/                  # ‚Üí API services
LS hooks/                     # ‚Üí Custom hooks
LS stores/                    # ‚Üí Zustand stores
```

```yaml
Frontend Data Layer:
  API Services:
    BaseService: [Pattern base com X-Org-Id headers]
    Type Safety: [Como TypeScript √© usado]
    Error Handling: [Pattern de tratamento de erros]

  State Management:
    Zustand Stores: [stores/ - estado global]
    TanStack Query: [Cache e sincroniza√ß√£o de dados]
    Organization Context: [useOrgContext hook]

  Custom Hooks:
    Data Fetching: [Hooks para API calls]
    Organization Context: [Multi-tenancy hooks]
    Form Handling: [React Hook Form integration]
```

#### **üìú FASE 6: AN√ÅLISE DE HIST√ìRICO E EVOLU√á√ÉO (15min)**

##### **6.1 An√°lise do Hist√≥rico de Desenvolvimento**

```bash
# OBRIGAT√ìRIO: Mapear evolu√ß√£o do projeto
Read CHANGELOG.md             # ‚Üí Hist√≥rico de features
Bash git log --oneline -20    # ‚Üí Commits recentes
Read docs/project/11-roadmap.md # ‚Üí Roadmap e status
```

```yaml
Project Evolution:
  CHANGELOG Analysis:
    Recent Features: [Features implementadas recentemente]
    Technical Decisions: [Decis√µes t√©cnicas documentadas]
    Architecture Changes: [Mudan√ßas arquiteturais]

  Git History:
    Recent Commits: [√öltimos commits significativos]
    Active Development: [√Åreas em desenvolvimento ativo]
    Stability: [Estabilidade da codebase]

  Roadmap Status:
    Completed Stories: [Hist√≥rias conclu√≠das]
    Current Focus: [Foco atual de desenvolvimento]
    Next Priorities: [Pr√≥ximas prioridades]
```

##### **6.2 An√°lise de Documenta√ß√£o e Padr√µes**

```bash
# OBRIGAT√ìRIO: Mapear documenta√ß√£o existente
Read CLAUDE.md               # ‚Üí Regras e padr√µes do projeto
Read README.md              # ‚Üí Overview e setup
LS docs/                    # ‚Üí Toda documenta√ß√£o dispon√≠vel
```

```yaml
Documentation Coverage:
  Project Documentation:
    CLAUDE.md: [Regras e padr√µes definidos]
    README.md: [Overview e instru√ß√µes de setup]
    Technical Docs: [docs/project/ - documenta√ß√£o t√©cnica]

  Development Guides:
    Architecture: [Padr√µes arquiteturais documentados]
    Multi-Tenancy: [Guias de implementa√ß√£o multi-tenant]
    API Guidelines: [Padr√µes de API documentados]

  Quality Standards:
    Code Standards: [Padr√µes de c√≥digo definidos]
    Testing Requirements: [Requisitos de teste]
    Security Guidelines: [Diretrizes de seguran√ßa]
```

#### **üéØ FASE 7: S√çNTESE E CONTEXTUALIZA√á√ÉO FINAL (10min)**

##### **7.1 Consolida√ß√£o do Contexto T√©cnico**

```yaml
Project Technical Context:
  Status: [Production-ready | In Development | Early Stage]
  Maturity: [Arquitetura estabelecida, padr√µes definidos]
  Complexity: [N√≠vel de complexidade t√©cnica]

  Core Capabilities:
    Multi-Tenancy: [Header-based isolation implementado]
    Authentication: [JWT com org context]
    API Coverage: [60+ endpoints production-ready]
    Frontend: [Admin √°rea completa com shadcn/ui]

  Development Readiness:
    Setup Complexity: [N√≠vel de dificuldade para setup]
    Documentation: [Qualidade e completude da documenta√ß√£o]
    Testing: [Coverage e estrat√©gia de testes]
    Deployment: [Railway deployment configurado]
```

##### **7.2 Identifica√ß√£o de Padr√µes Cr√≠ticos**

```yaml
Critical Patterns for Development:
  Must Follow:
    - Organization isolation obrigat√≥rio em TODOS os models
    - X-Org-Id header validation em TODOS os endpoints protegidos
    - shadcn/ui exclusivo para componentes UI
    - BaseService pattern para API calls frontend

  Architecture Decisions:
    - Clean Architecture: Router ‚Üí Service ‚Üí Repository ‚Üí Model
    - Multi-tenancy: Header-based com middleware validation
    - Frontend: App Router Next.js 14 com TypeScript
    - Database: PostgreSQL com SQLAlchemy 2.0

  Quality Standards:
    - 95% confidence rule para implementa√ß√µes
    - Evidence-based development (Read/LS/Bash)
    - KISS/YAGNI/DRY principles obrigat√≥rios
    - Auto-save de planos e documenta√ß√£o
```

---

## üìã **TEMPLATE DE OUTPUT OBRIGAT√ìRIO**

### **Estrutura do Contexto: COMPLETE PROJECT CONTEXTUALIZATION**

````markdown
# CONTEXTO COMPLETO DO PROJETO: [NOME-DO-PROJETO]

## üìä Status da An√°lise Contextual

- **An√°lise Realizada**: ‚úÖ [Data/Hora] - Contextualiza√ß√£o completa executada
- **Ferramentas Utilizadas**: ‚úÖ Read/LS/Bash/Grep para an√°lise real do codebase
- **Arquivos Analisados**: ‚úÖ [X] arquivos cr√≠ticos lidos e mapeados
- **Dependencies Mapeadas**: ‚úÖ [X] bibliotecas Frontend + [X] bibliotecas Backend
- **Endpoints Catalogados**: ‚úÖ [X] endpoints API mapeados e documentados
- **Models Analisados**: ‚úÖ [X] models SQLAlchemy + relacionamentos mapeados
- **Components Catalogados**: ‚úÖ [X] componentes shadcn/ui + [X] feature components
- **Migrations Verificadas**: ‚úÖ Vers√£o atual: [vers√£o] - Schema com [X] tabelas
- **Certeza Contextual**: ‚úÖ 99% (baseado em evid√™ncias reais do codebase)

---

## üèóÔ∏è **ARQUITETURA GERAL DO PROJETO**

### **üö® IDENTIFICA√á√ÉO CR√çTICA DO PROJETO**

```yaml
Project Identity:
  Nome: [Nome extra√≠do do package.json/README]
  Tipo: [SaaS Multi-tenant B2B/B2C]
  Status: [Production-ready | In Development | MVP]

Stack Principal:
  Frontend: Next.js [vers√£o] + TypeScript + shadcn/ui
  Backend: FastAPI [vers√£o] + SQLAlchemy [vers√£o]
  Database: PostgreSQL + Redis
  Deploy: Railway/[plataforma identificada]

Core Philosophy:
  - Multi-tenancy: Header-based organization isolation
  - Clean Architecture: Layered backend with DI
  - Type Safety: Full TypeScript + Pydantic
  - UI Framework: shadcn/ui components exclusively
```
````

### **üéØ PROP√ìSITO E DOM√çNIO**

```yaml
Business Domain: [Dom√≠nio de neg√≥cio identificado]
  Primary Use Case: [Caso de uso principal]
  Target Users: [Usu√°rios alvo]
  Core Value Prop: [Proposta de valor principal]

Key Features Implemented:
  - [Feature 1 identificada no c√≥digo]
  - [Feature 2 identificada no c√≥digo]
  - [Feature 3 identificada no c√≥digo]

Current Development Focus:
  - [√Årea de desenvolvimento ativa]
  - [Features in progress]
  - [Next priorities do roadmap]
```

---

## üîß **CONFIGURA√á√ïES E AMBIENTE**

### **üì¶ Dependencies e Vers√µes REAIS**

#### **Frontend Dependencies (package.json LIDO)**

```yaml
Core Framework:
  - next: [vers√£o EXATA encontrada]
  - react: [vers√£o EXATA encontrada]
  - typescript: [vers√£o EXATA encontrada]

UI & Styling:
  - @radix-ui/*: [vers√µes de componentes shadcn]
  - tailwindcss: [vers√£o EXATA]
  - lucide-react: [vers√£o para √≠cones]

Data & State:
  - @tanstack/react-query: [vers√£o para data fetching]
  - zustand: [vers√£o para state management]
  - react-hook-form: [vers√£o para forms]

Development:
  - @types/*: [vers√µes dos tipos TypeScript]
  - eslint: [vers√£o e configura√ß√µes]
  - prettier: [vers√£o e configura√ß√µes]
```

#### **Backend Dependencies (requirements.txt LIDO)**

```yaml
Core Framework:
  - fastapi: [vers√£o EXATA encontrada]
  - uvicorn: [vers√£o do server]
  - python: [vers√£o m√≠nima requerida]

Database:
  - sqlalchemy: [vers√£o EXATA]
  - alembic: [vers√£o para migrations]
  - psycopg2: [driver PostgreSQL]

Authentication & Security:
  - python-jose: [JWT handling]
  - passlib: [password hashing]
  - python-multipart: [form handling]

Development:
  - pytest: [vers√£o para testes]
  - black: [code formatting]
  - mypy: [type checking]
```

### **üåç Configura√ß√µes de Ambiente**

#### **Development Environment**

```yaml
Local Development:
  Frontend:
    Port: 3000
    Command: npm run dev / next dev

  Backend:
    Port: 8000
    Command: uvicorn api.main:app --reload

  Database:
    PostgreSQL: localhost:5432 via Docker
    Redis: localhost:6379 via Docker
    Migrations: ./migrate apply

Environment Variables (.env.example LIDO):
  - DATABASE_URL: [formato identificado]
  - SECRET_KEY: [padr√£o identificado]
  - REDIS_URL: [configura√ß√£o identificada]
  - [outras vars cr√≠ticas...]
```

#### **Production Environment**

```yaml
Deployment Platform: [Railway/Vercel/outros identificado]

Production Config:
  Frontend: [deployment config identificado]
  Backend: [deployment config identificado]
  Database: [PostgreSQL production config]

Health Checks:
  - Backend: /health endpoint
  - Database: Migration status
  - Cache: Redis connectivity

Environment Variables Production:
  - [vari√°veis cr√≠ticas para produ√ß√£o]
  - [secrets e configura√ß√µes sens√≠veis]
```

---

## üèõÔ∏è **ARQUITETURA BACKEND (FastAPI)**

### **üìÅ Estrutura de Diret√≥rios MAPEADA**

```yaml
api/ [Backend root - ESTRUTURA REAL LIDA]:
  core/:
    - config.py: [configura√ß√µes globais]
    - database.py: [SQLAlchemy setup]
    - deps.py: [dependency injection]
    - security.py: [JWT e autentica√ß√£o]
    - organization_middleware.py: [multi-tenancy CR√çTICO]

  models/:
    - user.py: [User model + relacionamentos]
    - organization.py: [Organization + multi-tenancy]
    - crm_lead.py: [CRM leads + pipeline]
    - [outros models identificados...]

  schemas/:
    - auth.py: [Pydantic schemas para auth]
    - organization.py: [Schemas de organiza√ß√£o]
    - crm_lead.py: [Schemas de CRM]
    - [outros schemas identificados...]

  repositories/:
    - base.py: [BaseRepository pattern]
    - user_repository.py: [User data access]
    - crm_lead_repository.py: [CRM data access]
    - [outros repositories identificados...]

  services/:
    - auth.py: [Business logic de auth]
    - organization_service.py: [Business logic org]
    - crm_lead_service.py: [Business logic CRM]
    - [outros services identificados...]

  routers/:
    - auth.py: [Endpoints de autentica√ß√£o]
    - organizations.py: [Endpoints de org]
    - crm_leads.py: [Endpoints de CRM]
    - [outros routers identificados...]
```

### **üîê Multi-Tenancy Implementation (CR√çTICO)**

```yaml
Organization Isolation Strategy:
  Method: Header-based isolation via X-Org-Id

  Middleware: api/core/organization_middleware.py
    Function: Valida X-Org-Id header em TODOS endpoints protegidos
    Security: JWT org_id DEVE casar com X-Org-Id header

  Models Pattern:
    ALL Models: organization_id FK obrigat√≥rio
    Indexes: organization_id index em TODAS as tabelas
    Queries: SEMPRE filtradas por organization_id

  Dependencies: api/core/deps.py
    get_current_organization(): Dependency injet√°vel
    Organization context: Autom√°tico em todos endpoints

  Repository Pattern:
    Base filtering: Todos queries incluem organization_id
    Isolation testing: Testes autom√°ticos de isolamento
    Performance: √çndices otimizados para multi-tenancy
```

### **üóÑÔ∏è Database Schema (REAL)**

```yaml
Schema Analysis (migrations/001_consolidated_schema.sql LIDO):

  Total Tables: [X tabelas identificadas]

  Core Multi-Tenant Tables:
    users:
      - id: UUID primary key
      - organization_id: UUID FK (nullable para users sem org)
      - [campos espec√≠ficos identificados...]

    organizations:
      - id: UUID primary key
      - owner_id: UUID FK para users
      - [campos espec√≠ficos identificados...]

    organization_members:
      - organization_id: UUID FK
      - user_id: UUID FK
      - role: Enum (owner, admin, member)
      - [campos espec√≠ficos identificados...]

  Feature Tables:
    crm_leads:
      - id: UUID primary key
      - organization_id: UUID FK [OBRIGAT√ìRIO]
      - stage: Pipeline stage
      - [campos espec√≠ficos identificados...]

    [outras tabelas mapeadas com organization_id...]

  Indexes Strategy:
    - organization_id index em TODAS tabelas multi-tenant
    - Composite indexes para queries de performance
    - [√≠ndices espec√≠ficos identificados...]
```

### **üîå API Endpoints (CATALOGADOS)**

```yaml
Authentication Endpoints (/auth):
  POST /auth/register: User registration
  POST /auth/login: User login
  POST /auth/logout: User logout
  GET /auth/me: Current user profile

Organization Endpoints (/organizations):
  GET /organizations/: List user organizations
  POST /organizations/: Create organization
  GET /organizations/{id}: Get organization details
  PUT /organizations/{id}: Update organization

CRM Endpoints (/crm):
  GET /crm/leads/: List organization leads
  POST /crm/leads/: Create lead
  GET /crm/leads/{id}: Get lead details
  PUT /crm/leads/{id}: Update lead
  DELETE /crm/leads/{id}: Delete lead

[outros endpoints identificados e catalogados...]

Multi-Tenancy Compliance:
  Protected Routes: [X endpoints] requerem X-Org-Id header
  Organization Middleware: Aplicado em [X rotas]
  Isolation Testing: [coverage de testes identificado]
```

---

## üé® **ARQUITETURA FRONTEND (Next.js 14)**

### **üìÅ Estrutura de Diret√≥rios MAPEADA**

```yaml
Frontend Structure (REAL LIDA):

  app/ [App Router Next.js 14]:
    [locale]/ [Internationalization]:
      admin/ [Admin √°rea multi-tenant]:
        - layout.tsx: [Admin layout]
        - page.tsx: [Dashboard]
        crm/: [CRM features]
          - page.tsx: [CRM main page]
        settings/: [Organization settings]
          - page.tsx: [Settings page]
        team/: [Team management]
          - page.tsx: [Team page]

      auth/ [Authentication]:
        login/: [Login page]
        register/: [Registration page]

      landing/: [Public marketing]
        - page.tsx: [Landing page]

  components/:
    ui/: [shadcn/ui components EXCLUSIVOS]
      - button.tsx: [Button component]
      - card.tsx: [Card component]
      - input.tsx: [Input component]
      - [outros componentes shadcn identificados...]

    crm/: [CRM feature components]
      - pipeline-kanban.tsx: [Kanban pipeline]
      - lead-create-modal.tsx: [Lead creation]
      - [outros components CRM identificados...]

    auth/: [Auth components]
      - login-form.tsx: [Login form]
      - register-form.tsx: [Register form]
      - [outros components auth identificados...]

    layout/: [Layout components]
      - header.tsx: [App header]
      - sidebar.tsx: [Admin sidebar]
      - [outros layout components...]
```

### **üîß Frontend Data Architecture**

```yaml
Services Layer (services/ MAPEADOS):
  Base Service Pattern:
    - base.ts: BaseService com X-Org-Id headers autom√°ticos
    - auth.ts: AuthService para autentica√ß√£o
    - crm-leads.ts: CRMLeadsService para leads
    - organizations.ts: OrganizationsService
    - [outros services identificados...]

  Type Safety:
    - TypeScript strict mode
    - API response types definidos
    - Form validation types

State Management (stores/ + hooks/):
  Zustand Stores:
    - auth.ts: Authentication state
    - organizations.ts: Organization context
    - [outros stores identificados...]

  Custom Hooks:
    - use-org-context.ts: Organization context [CR√çTICO]
    - use-auth.ts: Authentication hook
    - [outros hooks identificados...]

  TanStack Query:
    - API caching autom√°tico
    - Background refetching
    - Error handling padronizado
```

### **üé® UI Components Strategy**

```yaml
UI Framework: shadcn/ui EXCLUSIVO

  shadcn/ui Components Instalados:
    - [Lista EXATA dos componentes instalados em components/ui/]
    - Button: [bot√µes padronizados]
    - Card: [cards de conte√∫do]
    - Input: [inputs de formul√°rio]
    - Dialog: [modals e dialogs]
    - [outros components identificados...]

  Customization Policy:
    - ZERO customiza√ß√µes CSS
    - APENAS componentes oficiais shadcn/ui
    - Tailwind classes para layout
    - Lucide icons para iconografia

  Component Decomposition:
    Pattern: [feature]/[component]-[helpers].tsx
    Example: crm/pipeline-kanban-layout.tsx
    Benefit: Escalabilidade e manutenibilidade
```

---

## üìä **AN√ÅLISE DE ESTADO ATUAL E MATURIDADE**

### **üéØ Status de Implementa√ß√£o**

```yaml
Project Maturity Assessment:

  Overall Status: [Production-ready | MVP | In Development]
    - Database Schema: [X tables] ‚úÖ Consolidado
    - API Endpoints: [X endpoints] ‚úÖ Production-ready
    - Frontend Components: [X components] ‚úÖ shadcn/ui compliant
    - Multi-tenancy: ‚úÖ Header-based isolation implementado
    - Authentication: ‚úÖ JWT com org context
    - Deployment: ‚úÖ Railway production deployment

  Code Quality:
    - TypeScript Coverage: [%] identificado
    - Test Coverage: [information from tests/ analysis]
    - Linting: ESLint + Prettier configurado
    - Code Standards: Black + isort + mypy (backend)

  Documentation Coverage:
    - CLAUDE.md: ‚úÖ Padr√µes e regras definidos
    - README.md: ‚úÖ Setup e overview
    - API Documentation: [FastAPI auto-generated]
    - Architecture Docs: docs/project/ [coverage identificado]
```

### **üîç √Åreas de Desenvolvimento Ativo**

```yaml
Current Development Focus (baseado em CHANGELOG + Git history):
  Recently Completed:
    - [Features recentes do CHANGELOG]
    - [Commits significativos recentes]

  In Progress:
    - [√Åreas de desenvolvimento ativo identificadas]
    - [Features em constru√ß√£o]

  Next Priorities (baseado no roadmap):
    - [Pr√≥ximas hist√≥rias do roadmap]
    - [Melhorias t√©cnicas planejadas]

  Technical Debt:
    - [√Åreas que precisam refatora√ß√£o]
    - [Melhorias de performance identificadas]
    - [Atualiza√ß√µes de depend√™ncias necess√°rias]
```

---

## üìã **PADR√ïES DE DESENVOLVIMENTO OBRIGAT√ìRIOS**

### **üö® REGRAS FUNDAMENTAIS (CR√çTICAS)**

```yaml
Multi-Tenancy Rules (NON-NEGOTIABLE):
  1. EVERY protected endpoint MUST validate X-Org-Id header
  2. ALL models MUST include organization_id FK
  3. ALL queries MUST filter by organization_id
  4. NEVER trust client-provided org_id without validation

Code Quality Rules:
  1. 95% confidence rule: Never proceed without evidence
  2. Evidence-based development: Always use Read/LS/Bash
  3. KISS/YAGNI/DRY principles: Non-negotiable
  4. TypeScript strict mode: Required everywhere

UI/UX Rules:
  1. shadcn/ui components ONLY: No custom CSS components
  2. Tailwind classes for layout: No custom CSS
  3. Lucide icons exclusively: Consistent iconography
  4. Component decomposition: Scalable architecture
```

### **üìê Coding Patterns (ESTABLISHED)**

```yaml
Backend Patterns:
  Router ‚Üí Service ‚Üí Repository ‚Üí Model:
    - Routers: HTTP handling only
    - Services: Business logic + validation
    - Repositories: Data access + org filtering
    - Models: SQLAlchemy + relationships

  Error Handling:
    - HTTPException with specific status codes
    - Structured error responses
    - Logging with context

  Dependency Injection:
    - FastAPI Depends pattern
    - get_current_organization: Always use
    - Database sessions: Proper lifecycle management

Frontend Patterns:
  Component Architecture:
    - Feature-based organization
    - Decomposition for complex components
    - Custom hooks for logic separation

  Data Flow:
    - TanStack Query for server state
    - Zustand for client state
    - Form validation with react-hook-form

  Type Safety:
    - API response types
    - Form validation schemas
    - Component prop types
```

---

## üõ†Ô∏è **COMANDOS DE DESENVOLVIMENTO**

### **Setup e Desenvolvimento**

```bash
# First-time setup
make setup                    # Install deps + DB + migrations
npm install                   # Frontend dependencies
pip install -r requirements.txt # Backend dependencies

# Development
npm run dev                   # Both servers (Frontend:3000, Backend:8000)
npm run next-dev             # Frontend only
uvicorn api.main:app --reload # Backend only

# Database
docker-compose up -d postgres redis # Start local DB
cd migrations && ./migrate apply     # Apply migrations
cd migrations && ./migrate status    # Check migration status
```

### **Testing e Qualidade**

```bash
# Testing
npm run test:frontend        # Frontend unit tests
python3 -m pytest           # Backend unit tests
npm run test:e2e            # E2E tests (Playwright)

# Code Quality
npm run lint                # All linters (frontend + backend)
npm run typecheck          # TypeScript validation
npm run format             # Code formatting

# Specific Linting
npm run lint:frontend       # ESLint + Prettier
npm run lint:backend        # Black + isort + flake8 + mypy
```

### **Database e Migrations**

```bash
# Migration Management
cd migrations && ./migrate help      # Migration commands
cd migrations && ./migrate apply     # Apply pending migrations
cd migrations && ./migrate status    # Check current version
cd migrations && ./migrate init      # Initialize migration system

# Database Operations
make connect-db-prod                 # Connect to production DB
make db-prod-status                  # Production DB health check
```

---

## ‚ö†Ô∏è **ALERTAS E CUIDADOS CR√çTICOS**

### **üö® SECURITY CRITICAL**

```yaml
Multi-Tenancy Security: NEVER bypass organization_id filtering
  ALWAYS validate X-Org-Id header on protected routes
  NEVER trust client-provided organization context

Authentication Security: JWT tokens MUST include org_id claim
  Session management via Redis required
  Password hashing with proper salt rounds

Database Security: ALL queries MUST include organization_id filter
  Prevent SQL injection via SQLAlchemy ORM
  Connection pooling for performance + security
```

### **‚ö° Performance Considerations**

```yaml
Database Performance:
  organization_id indexes: Required on ALL tables
  Query optimization: Monitor N+1 query problems
  Connection pooling: Configured for multi-tenancy

Frontend Performance:
  Component memoization: Where appropriate
  Image optimization: Next.js built-in optimization
  Bundle analysis: Monitor bundle size growth

API Performance:
  Response caching: Redis integration
  Pagination: Required for list endpoints
  Rate limiting: Configured per organization
```

### **üîß Development Gotchas**

```yaml
Common Issues:
  Missing X-Org-Id: API calls fail with 400
  Wrong org context: Data isolation violations
  Dependency conflicts: Lock file versions
  Migration issues: Always backup before apply

Debugging Tips:
  Multi-tenancy: Check organization_id in ALL queries
  API errors: Validate headers and authentication
  Build failures: Check TypeScript and linting
  Test failures: Verify test database isolation
```

---

## üéØ **PR√ìXIMOS PASSOS RECOMENDADOS**

### **Para Novos Desenvolvedores**

```yaml
Onboarding Checklist:
  1. Setup completo: make setup
  2. Ler CLAUDE.md: Padr√µes e regras
  3. Explorar codebase: Seguir patterns identificados
  4. Implementar feature simples: Seguir workflow exec-*
  5. Code review: Validar conformidade com padr√µes

Key Files to Understand:
  - api/core/organization_middleware.py: Multi-tenancy core
  - components/providers/auth-provider.tsx: Auth context
  - services/base.ts: API service pattern
  - api/core/deps.py: Dependency injection
```

### **Para Desenvolvimento Cont√≠nuo**

```yaml
Development Workflow:
  1. exec-refine: Technical refinement for complex features
  2. exec-story: Detailed execution planning
  3. Implementation: Following generated plans
  4. exec-review: Quality gate validation

Quality Gates:
  - Multi-tenancy compliance: Mandatory
  - Test coverage: Maintain existing levels
  - Documentation updates: Keep synchronized
  - Performance monitoring: Track metrics
```

---

## üíæ **CONFIRMA√á√ÉO DE CONTEXTUALIZA√á√ÉO**

### **‚úÖ CONTEXTO MAPEADO COM SUCESSO**

```yaml
Contextualization Completed:
  Timestamp: [YYYY-MM-DD HH:MM:SS]
  Duration: [X minutes]

Files Analyzed:
  Configuration: [X arquivos] ‚úÖ
  Backend Code: [X arquivos] ‚úÖ
  Frontend Code: [X arquivos] ‚úÖ
  Database Schema: [X arquivos] ‚úÖ
  Documentation: [X arquivos] ‚úÖ

Evidence Collected:
  Dependencies: [X frontend + X backend] ‚úÖ
  Endpoints: [X endpoints catalogados] ‚úÖ
  Components: [X components mapeados] ‚úÖ
  Models: [X models analisados] ‚úÖ
  Migrations: [vers√£o atual identificada] ‚úÖ

Context Accuracy: 99% (baseado em an√°lise real do codebase)
Ready for Development: ‚úÖ Contexto completo dispon√≠vel
```

### **üìÅ CONTEXTO PERSISTIDO**

```yaml
Context Saved:
  Path: docs/context/PROJECT-CONTEXT-[TIMESTAMP].md
  Size: [X] KB
  Status: ‚úÖ Arquivo salvo com sucesso

CHANGELOG Updated:
  Path: CHANGELOG.md (raiz do projeto)
  Entry: ## [Context] - [YYYY-MM-DD]
  Status: ‚úÖ Entrada de contextualiza√ß√£o adicionada

Validation:
  File Access: ‚úÖ Arquivo criado e acess√≠vel
  Content Complete: ‚úÖ Todas se√ß√µes preenchidas
  Evidence Based: ‚úÖ Baseado em an√°lise real
```

### **üîó INTEGRA√á√ÉO COM WORKFLOW**

```yaml
Usage Recommendations:
  - Reference Document: Consultar antes de exec-refine/story
  - Onboarding Guide: Para novos desenvolvedores
  - Architecture Reference: Para decis√µes t√©cnicas
  - Quality Baseline: Para manter padr√µes estabelecidos

Next Steps:
  - Development: Use context para exec-refine/story informados
  - Updates: Re-run exec-context ap√≥s mudan√ßas significativas
  - Sharing: Document dispon√≠vel para toda a equipe
  - Evolution: Context evolui com o projeto
```

---

**üö® CONTEXTO COMPLETO**: Este documento foi gerado atrav√©s de an√°lise sistem√°tica e completa do codebase real. Toda informa√ß√£o √© baseada em evid√™ncias diretas dos arquivos do projeto, garantindo 99% de precis√£o sobre o estado atual, arquitetura, padr√µes e configura√ß√µes implementadas.

**üéØ PRONTO PARA DESENVOLVIMENTO**: Com este contexto completo, qualquer desenvolvedor pode executar exec-refine, exec-story, exec-run com m√°xima confian√ßa e ader√™ncia aos padr√µes estabelecidos do projeto.

---

````

---

## üéØ **VALIDA√á√ïES FINAIS OBRIGAT√ìRIAS**

### **COMPLETE CONTEXTUALIZATION CHECKLIST**
- [ ] **Configuration Analysis**: Todas configura√ß√µes mapeadas via Read de arquivos reais
- [ ] **Dependencies Mapping**: package.json + requirements.txt completamente analisados
- [ ] **Architecture Documentation**: Estrutura completa de diret√≥rios mapeada via LS
- [ ] **Database Schema**: migrations/ e models/ completamente analisados
- [ ] **API Endpoints**: Todos routers mapeados e endpoints catalogados
- [ ] **Frontend Components**: Todos components/ analisados e padr√µes identificados
- [ ] **Multi-tenancy Validation**: Organization isolation patterns validados
- [ ] **Historical Analysis**: CHANGELOG + git history analisados
- [ ] **Documentation Coverage**: Toda documenta√ß√£o existente mapeada
- [ ] **Evidence-Based**: Cada informa√ß√£o baseada em leitura real de arquivos

### **üö® CONTEXT QUALITY GATES**
- ‚ùå **FALHA CR√çTICA se n√£o usar ferramentas Read/LS/Bash/Grep para an√°lise real**
- ‚ùå **FALHA CR√çTICA se template n√£o mostrar evid√™ncias CONCRETAS de leitura**
- ‚ùå **FALHA CR√çTICA se basear contexto em suposi√ß√µes sobre o projeto**
- ‚ùå **REJEI√á√ÉO AUTOM√ÅTICA se n√£o mapear multi-tenancy patterns**
- ‚ùå **REJEI√á√ÉO AUTOM√ÅTICA se n√£o catalogar dependencies reais**
- ‚ùå **REJEI√á√ÉO AUTOM√ÅTICA se n√£o analisar database schema atual**

### **INTEGRATION REQUIREMENTS**
- **Complete Coverage**: Contexto deve cobrir 100% dos aspectos cr√≠ticos do projeto
- **Evidence Based**: Toda informa√ß√£o baseada em an√°lise direta dos arquivos
- **Pattern Recognition**: Identificar e documentar todos os padr√µes estabelecidos
- **Current State**: Refletir exatamente o estado atual, n√£o um estado assumido

---

## üö´ **ANTI-PATTERNS DETECTADOS AUTOMATICAMENTE**

### **RED FLAGS - PARAR IMEDIATAMENTE**
- üö® N√£o conseguir acessar arquivos fundamentais do projeto
- üö® Dependencies conflitantes ou corrompidas detectadas
- üö® Schema de banco inconsistente ou migrations quebradas
- üö® Padr√µes multi-tenancy n√£o implementados ou quebrados
- üö® Configura√ß√µes cr√≠ticas faltando ou inv√°lidas
- üö® Build ou testes fundamentais falhando

### **CONTEXTUALIZATION REQUIREMENTS**
- **Minimum Completeness**: Deve mapear 100% da arquitetura cr√≠tica
- **Zero Assumptions**: Nenhuma informa√ß√£o baseada em suposi√ß√£o
- **Pattern Consistency**: Deve identificar padr√µes estabelecidos
- **Current Accuracy**: Deve refletir estado atual exato do projeto

---

**LEMBRETE CR√çTICO**: Este agente gera CONTEXTUALIZA√á√ÉO COMPLETA baseada em **LEITURA REAL E SISTEM√ÅTICA DO CODEBASE**, n√£o em suposi√ß√µes ou conhecimento pr√©vio. O contexto deve ser t√£o preciso e completo que qualquer desenvolvedor possa usar como refer√™ncia definitiva para entender totalmente o projeto. **AN√ÅLISE F√çSICA DOS ARQUIVOS** √© obrigat√≥ria para m√°xima precis√£o contextual.

---

## üìÅ **AUTO-SAVE OBRIGAT√ìRIO - PERSIST√äNCIA DO CONTEXTO**

### **üö® SALVAMENTO AUTOM√ÅTICO MANDAT√ìRIO**

**O agente DEVE SEMPRE salvar automaticamente o contexto completo em arquivo markdown E atualizar o CHANGELOG.md na raiz para preservar baseline de conhecimento.**

#### **üìã REGRAS DE SALVAMENTO**
- ‚úÖ **DEVE**: Salvar automaticamente TODOS os contextos gerados
- ‚úÖ **DEVE**: Usar diret√≥rio: `docs/context/`
- ‚úÖ **DEVE**: Formato filename: `PROJECT-CONTEXT-[YYYY-MM-DD-HHMMSS].md`
- ‚úÖ **DEVE**: Timestamp para versionamento de contextos
- ‚úÖ **DEVE**: Gerar/atualizar CHANGELOG.md na raiz com entrada de contextualiza√ß√£o
- ‚úÖ **DEVE**: Confirmar salvamento com paths completos no final
- ‚ùå **NUNCA**: Gerar contexto sem salvar em arquivo
- ‚ùå **NUNCA**: Gerar contexto sem atualizar CHANGELOG.md
- ‚ùå **NUNCA**: Sobrescrever contexto sem timestamp √∫nico

#### **üíæ PROCESSO DE SALVAMENTO**

```yaml
Step 1: Gerar Timestamp
  - Format: YYYY-MM-DD-HHMMSS
  - Example: 2025-01-08-143052

Step 2: Criar Filename
  - Format: PROJECT-CONTEXT-[timestamp].md
  - Example: PROJECT-CONTEXT-2025-01-08-143052.md

Step 3: Salvar Contexto
  - Path: docs/context/PROJECT-CONTEXT-[timestamp].md
  - Content: Contexto completo gerado
  - Validation: Arquivo salvo com sucesso

Step 4: Atualizar CHANGELOG
  - Path: CHANGELOG.md (raiz do projeto)
  - Content: Entrada de contextualiza√ß√£o
  - Action: Adicionar no topo do CHANGELOG

Step 5: Confirmar Salvamento
  - Output: "‚úÖ CONTEXTO SALVO: docs/context/PROJECT-CONTEXT-[timestamp].md"
  - Output: "‚úÖ CHANGELOG ATUALIZADO: CHANGELOG.md"
  - Validation: Ambos arquivos salvos com sucesso
````

#### **üìù FORMATO CHANGELOG PARA CONTEXTO**

```markdown
## [Context] - 2025-01-08

### üìä Project Contextualization

- **Complete Context Generated**: Full project analysis and documentation
- **Architecture Mapped**: [X] directories, [X] files analyzed
- **Dependencies Catalogued**: [X] frontend + [X] backend dependencies
- **API Endpoints Documented**: [X] endpoints across [X] routers
- **Database Schema Analyzed**: [X] tables with full relationships
- **Components Catalogued**: [X] UI components + [X] feature components
- **Multi-tenancy Validated**: Organization isolation patterns confirmed
- **Evidence-Based Analysis**: 100% based on real codebase examination

### üîß Technical Baseline

- **Stack Confirmed**: Next.js [version] + FastAPI [version] + PostgreSQL
- **Deployment Platform**: Railway production-ready
- **UI Framework**: shadcn/ui exclusive compliance validated
- **Architecture Pattern**: Clean Architecture with multi-tenant isolation

### üîó References

- **Context Document**: `docs/context/PROJECT-CONTEXT-[timestamp].md`
- **Analysis Method**: Systematic codebase examination using Read/LS/Bash tools
- **Accuracy Level**: 99% based on direct file analysis

---
```
